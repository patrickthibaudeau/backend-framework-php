{{! navigation partial for top bar }}
<header class="bg-white shadow-sm sticky top-0 z-40">
  <!-- full width container -->
  <div class="w-full px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    <div class="flex items-center gap-6">
      <div class="flex items-center gap-3">
        {{#is_authenticated}}
        <button type="button" class="inline-flex md:hidden items-center justify-center w-9 h-9 rounded-lg bg-brand-600 text-white focus-ring" @click="drawerOpen = !drawerOpen" :aria-expanded="drawerOpen.toString()" aria-controls="sidebar-nav">
          <svg x-show="!drawerOpen" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/></svg>
          <svg x-show="drawerOpen" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
        {{/is_authenticated}}
        <!-- Updated Logo: fills nav height proportionally without button styling -->
        <a href="/" class="flex items-center h-16 shrink-0 group" aria-label="{{site_name}}">
          <img src="/theme_assets.php?path=logo" alt="{{site_name}}" class="h-10 w-auto max-h-full object-contain select-none pointer-events-none transition-transform duration-150 group-hover:scale-105" loading="lazy" decoding="async" height="40">
        </a>
        <span class="font-semibold text-lg hidden md:inline-block leading-tight">{{site_name}}</span>
      </div>
      <nav class="hidden md:flex items-center gap-6 text-sm" aria-label="Primary">
        {{#is_authenticated}}
        {{#nav}}
        <a href="{{url}}" class="hover:text-brand-600 transition-colors {{#active}}text-brand-600 font-medium{{/active}}" aria-current="{{#active}}page{{/active}}">{{label}}</a>
        {{/nav}}
        {{/is_authenticated}}
      </nav>
    </div>
    <div class="flex items-center gap-3">
      {{#user}}
      {{#logout_url}}
      <div class="relative" x-data="{ openUser:false }" @keydown.escape.window="openUser=false">
        <button type="button" @click="openUser=!openUser" :aria-expanded="openUser.toString()" class="group inline-flex items-center gap-2 text-sm text-slate-600 hover:text-brand-600 focus-ring">
          <span>{{#str}}signed_in_as, theme_default{{/str}} <strong>{{username}}</strong></span>
          <svg class="h-4 w-4 transition-transform duration-150 text-slate-500 group-hover:text-brand-600" :class="{'rotate-180':openUser}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
        </button>
        <div x-cloak x-show="openUser" @click.outside="openUser=false" x-transition.opacity x-transition.duration.100ms class="absolute right-0 mt-2 w-48 rounded-md border border-slate-200 bg-white shadow-lg ring-1 ring-black/5 focus:outline-none z-50">
          <div class="py-1 text-sm">
            <a href="/preferences.php" class="flex items-center gap-2 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-800">
              <svg class="h-4 w-4 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l4 2"/><circle cx="12" cy="12" r="10"/></svg>
              {{#str}}preferences, theme_default{{/str}}
            </a>
            <a href="{{logout_url}}" class="flex items-center gap-2 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-800">
              <svg class="h-4 w-4 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7"/><path stroke-linecap="round" stroke-linejoin="round" d="M7 4h6a4 4 0 014 4v0"/></svg>
              {{#str}}logout, theme_default{{/str}}
            </a>
          </div>
        </div>
      </div>
      {{/logout_url}}
      {{^logout_url}}
      <span class="text-sm text-slate-600">{{#str}}signed_in_as, theme_default{{/str}} <strong>{{username}}</strong></span>
      {{/logout_url}}
      {{/user}}
      {{#login_url}}
      <a href="{{login_url}}" class="text-sm text-brand-600 hover:underline">{{#str}}login, theme_default{{/str}}</a>
      {{/login_url}}
    </div>
  </div>
</header>
