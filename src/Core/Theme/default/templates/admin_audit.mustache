<div class="flex items-center justify-between mb-6">
  <h1 class="text-2xl font-bold">RBAC Audit Log</h1>
  <a href="{{home_link}}" class="text-blue-600 hover:underline">‚Üê Admin Home</a>
</div>
<form method="get" class="bg-white p-4 rounded shadow grid md:grid-cols-6 gap-4 text-sm mb-6">
  <div>
    <label class="block mb-1 text-xs font-medium">Action</label>
    <input name="action" value="{{filters.action}}" class="w-full border rounded px-2 py-1" placeholder="create_role" />
  </div>
  <div>
    <label class="block mb-1 text-xs font-medium">Actor (id/username)</label>
    <input name="actor" value="{{filters.actor}}" class="w-full border rounded px-2 py-1" placeholder="admin" />
  </div>
  <div>
    <label class="block mb-1 text-xs font-medium">Role (id/shortname)</label>
    <input name="role" value="{{filters.role}}" class="w-full border rounded px-2 py-1" placeholder="editor" />
  </div>
  <div>
    <label class="block mb-1 text-xs font-medium">Capability</label>
    <input name="cap" value="{{filters.cap}}" class="w-full border rounded px-2 py-1" placeholder="auth:add" />
  </div>
  <div>
    <label class="block mb-1 text-xs font-medium">Page</label>
    <input name="page" type="number" value="{{pagination.page}}" class="w-full border rounded px-2 py-1" />
  </div>
  <div class="flex items-end">
    <button class="bg-blue-600 text-white px-4 py-2 rounded w-full">Filter</button>
  </div>
</form>
<div class="bg-white rounded shadow overflow-auto mb-6">
  <table class="min-w-full text-xs">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-3 py-2 text-left">ID</th>
        <th class="px-3 py-2 text-left">Action</th>
        <th class="px-3 py-2 text-left">Actor</th>
        <th class="px-3 py-2 text-left">Target User</th>
        <th class="px-3 py-2 text-left">Role</th>
        <th class="px-3 py-2 text-left">Capability</th>
        <th class="px-3 py-2 text-left">Details</th>
        <th class="px-3 py-2 text-left">IP</th>
        <th class="px-3 py-2 text-left">Time</th>
      </tr>
    </thead>
    <tbody>
    {{#rows}}
      <tr class="border-t hover:bg-gray-50">
        <td class="px-3 py-1">{{id}}</td>
        <td class="px-3 py-1 font-medium">{{action}}</td>
        <td class="px-3 py-1">{{actor}}</td>
        <td class="px-3 py-1">{{targetuser}}</td>
        <td class="px-3 py-1">{{role}}</td>
        <td class="px-3 py-1">{{capability}}</td>
        <td class="px-3 py-1 max-w-xs truncate" title="{{details_full}}">{{details_short}}</td>
        <td class="px-3 py-1">{{ip}}</td>
        <td class="px-3 py-1" title="{{time_iso}}">{{time}}</td>
      </tr>
    {{/rows}}
    {{^rows}}
      <tr><td colspan="9" class="px-3 py-4 text-center text-gray-500">No audit entries found.</td></tr>
    {{/rows}}
    </tbody>
  </table>
</div>
<div class="flex justify-between items-center text-xs">
  <div>Total: {{pagination.total}} entries</div>
  <div class="space-x-1">
    {{#pagination.pages}}
      <a class="px-2 py-1 rounded {{#current}}bg-blue-600 text-white{{/current}}{{^current}}bg-white border text-blue-700{{/current}}" href="?{{query}}">{{num}}</a>
    {{/pagination.pages}}
  </div>
</div>
